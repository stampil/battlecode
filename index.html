<!DOCTYPE html>
<html>
<head>

    <title>battlecode</title>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="css/main.css"/>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
    
</head>


<body>
<h1>V0.0.1</h1>

<script>
 function scan(){   
    cordova.plugins.barcodeScanner.scan(
      function (result) {
          var ret = "We got a barcode\n" +
                "Result: " + result.text + "\n" +
                "Format: " + result.format + "\n" +
                "Cancelled: " + result.cancelled;
            document.getElementById('ret').innerText=ret;
            if(result.text) ajax('setCodeBar.php','result='+result.text+'&format='+result.format+'&id_gsm=123');
      }, 
      function (error) {
          var ret = "Scanning failed: " + error;
           document.getElementById('ret').innerText=ret;
      }
   );
 }  
 
function API_SC(data) {
    document.getElementById("ret2").innerHTML=JSON.stringify(data);
} 
    
function ajax($page,$param){
    document.getElementById("ret2").innerHTML='loading...';
    var head = document.getElementsByTagName('head').item(0);
    var script = document.createElement('script');
    script.setAttribute('type', 'text/javascript');
    script.setAttribute('src', 'http://vps36292.ovh.net/mordu/BATTLECODE/'.$page.'?'.$param);
    head.appendChild(script);
    }
</script>

<input type="button" value="scan" onclick="scan()" />

<div id="ret"></div>
<div id="ret2"></div>


</body>
</html>
